<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add and Extend UTR (Untranslated Region) Annotations in Genomic Data — add_UTR • GTF.tool</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add and Extend UTR (Untranslated Region) Annotations in Genomic Data — add_UTR"><meta property="og:description" content="This function extends genomic annotations by predicting and adding 5' and 3'
untranslated regions (UTRs) for selected transcripts. It evaluates the
distance to neighboring genes on the same chromosome and strand, and adjusts
UTR lengths dynamically to avoid overlaps while maximizing realistic UTR
extension.
The function requires annotations pre-loaded with `load_annotation()` and
formatted using `create_GTF_df()`."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GTF.tool</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add and Extend UTR (Untranslated Region) Annotations in Genomic Data</h1>

    <div class="hidden name"><code>add_UTR.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function extends genomic annotations by predicting and adding 5' and 3'
untranslated regions (UTRs) for selected transcripts. It evaluates the
distance to neighboring genes on the same chromosome and strand, and adjusts
UTR lengths dynamically to avoid overlaps while maximizing realistic UTR
extension.</p>
<p>The function requires annotations pre-loaded with `load_annotation()` and
formatted using `create_GTF_df()`.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_UTR</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  five_prime_utr_length <span class="op">=</span> <span class="fl">400</span>,</span>
<span>  three_prime_utr_length <span class="op">=</span> <span class="fl">800</span>,</span>
<span>  biotype <span class="op">=</span> <span class="st">"protein_coding"</span>,</span>
<span>  transcript_limit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  meta_string <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  genetic_elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRANSCRIPT"</span>, <span class="st">"MRNA"</span>, <span class="st">"CDS"</span><span class="op">)</span>,</span>
<span>  remove_original <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-input">input<a class="anchor" aria-label="anchor" href="#arg-input"></a></dt>
<dd><p>A data frame containing genomic annotation data. Required columns:
- `chr`: Chromosome identifier
- `start`: Genomic start position
- `end`: Genomic end position
- `strand`: Strand ('+' or '-')
- `annotationType`: Annotation type (e.g. 'EXON', 'CDS', 'TRANSCRIPT')
- `gene_name`: Gene identifier
- Additional fields such as `transcript_id`, `metadata`, `gene_type` are also used if present.</p></dd>


<dt id="arg-five-prime-utr-length">five_prime_utr_length<a class="anchor" aria-label="anchor" href="#arg-five-prime-utr-length"></a></dt>
<dd><p>Integer. Default 5' UTR length to add (default: 400 bp).</p></dd>


<dt id="arg-three-prime-utr-length">three_prime_utr_length<a class="anchor" aria-label="anchor" href="#arg-three-prime-utr-length"></a></dt>
<dd><p>Integer. Default 3' UTR length to add (default: 800 bp).</p></dd>


<dt id="arg-biotype">biotype<a class="anchor" aria-label="anchor" href="#arg-biotype"></a></dt>
<dd><p>Character string or vector indicating gene biotypes to include
(default: `"protein_coding"`).
Only transcripts whose `gene_type` matches the biotype(s) will be extended.
If provided biotype is absent in the input, a warning is printed.</p></dd>


<dt id="arg-transcript-limit">transcript_limit<a class="anchor" aria-label="anchor" href="#arg-transcript-limit"></a></dt>
<dd><p>Integer or NULL.
If provided, transcripts shorter than this length (calculated as `end - start`)
are excluded from UTR prediction. Useful for filtering out short non-coding
transcripts or partial gene fragments.</p></dd>


<dt id="arg-meta-string">meta_string<a class="anchor" aria-label="anchor" href="#arg-meta-string"></a></dt>
<dd><p>Character or NULL.
If provided, transcripts are filtered based on a case-insensitive pattern
matched against the `metadata` column. This enables selective extension
of transcripts based on additional meta-annotations (e.g., `"REFSEQ"`, `"ENST"`).</p></dd>


<dt id="arg-genetic-elements">genetic_elements<a class="anchor" aria-label="anchor" href="#arg-genetic-elements"></a></dt>
<dd><p>Character vector of annotation types to consider as
transcript-defining elements (default: `c("TRANSCRIPT", "MRNA", "CDS")`).
Only genes containing these annotation types will undergo UTR extension.</p></dd>


<dt id="arg-remove-original">remove_original<a class="anchor" aria-label="anchor" href="#arg-remove-original"></a></dt>
<dd><p>Logical. If TRUE (default), original transcript
annotations are removed and replaced exclusively by JBIO-predicted versions.
This prevents duplicated transcript names with conflicting coordinates,
which may break compatibility with certain bioinformatics tools.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame containing:
  - Original annotation rows
  - Additional predicted:
      * `five_prime_UTR`
      * `three_prime_UTR`
      * full `transcript` models</p>
<p>All predicted rows include:
  - `source = "JBIO-predicted"`
  - Updated `start` / `end` positions
  - Strand maintained from the input
  - `score = "."` and `phase = "."`</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function:
1. Iterates over chromosomes and strands.
2. For each gene, identifies valid transcript-defining annotation elements.
3. Computes available genomic space before and after the transcript.
4. Dynamically adjusts UTR lengths based on:
     - Proximity to the next and previous gene,
     - Strand orientation,
     - Configurable thresholds (full, 1/2, 1/3 compression),
     - Minimum non-negative UTR lengths.
5. Produces new transcript entries spanning predicted UTRs and original CDS/exons.</p>
<p>The algorithm ensures that predicted UTRs do **not overlap** neighboring genes,
and that transcript boundaries remain biologically realistic.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run the function</span></span></span>
<span class="r-in"><span><span class="va">output_data</span> <span class="op">&lt;-</span> <span class="fu">add_UTR</span><span class="op">(</span><span class="va">input</span>, five_prime_utr_length <span class="op">=</span> <span class="fl">400</span>, three_prime_utr_length <span class="op">=</span> <span class="fl">800</span>, genetic_elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EXON"</span>, <span class="st">"CDS"</span>, <span class="st">"TRANSCRIPT"</span>, <span class="st">"MRNA"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  UTRs sequence extending...             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'input' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jakub Kubiś - JBioSystem.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

